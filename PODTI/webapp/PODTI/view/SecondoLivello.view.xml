<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:t="sap.ui.table" xmlns:l="sap.ui.layout" xmlns:f="sap.ui.layout.form" xmlns:core="sap.ui.core" xmlns:html="http://www.w3.org/1999/xhtml" controllerName="kpmg.custom.pod.PODTI.PODTI.controller.SecondoLivello" width="100%" height="100%">   
    <Page title="{i18n>SecondoLivello.title}" class="kpmgGDPage" showHeader="false" enableScrolling="true">
        <content>
            <VBox width="100%" height="100%" renderType="Bare" class="mainContainer">
                <t:TreeTable id="treeTableSecondoLivello" rowSelectionChange="onSelectionSecondoOrTerzoLivello" selectionMode="Single"  
                class="kpmgGDTable" rows="{SecondoLivelloModel>/operations}" enableColumnReordering="true" enableGrouping="true" selectionBehavior="RowOnly"
                visibleRowCountMode="Auto" visibleRowCount="10" rowHeight="45px" >
                    <t:layoutData>
                        <FlexItemData growFactor="1" baseSize="0%"/>
                    </t:layoutData>
                    <t:extension>
                    <OverflowToolbar style="Clear">    
                        <HBox width="60%" height="100%" renderType="Bare" class="leftButtonsPODOperation"></HBox>       
                        <ToolbarSpacer/>     
                        <HBox renderType="Bare" width="auto" height="100%" justifyContent="Center" alignItems="Center">
                            <Label text="Machine Type: "></Label>
                            <ComboBox id="machineTypeId" placeholder="{i18n>SecondoLivello.treeTable.placeholder.insertMachineType}" class="GDComboBoxField" items="{MachineTypeModel>/machineTypes}" showSecondaryValues="true" change="onChangeMachineType">
                                <core:ListItem key="{MachineTypeModel>machine_type}" text="{MachineTypeModel>machine_type}" additionalText="{MachineTypeModel>wbe}" />
                            </ComboBox>    
                        </HBox>
                    </OverflowToolbar>
                    </t:extension>
                    <t:columns>
                        <t:Column width="44%" hAlign="Left" sortProperty="macroAttivita" filterProperty="macroAttivita">
                            <Label text="{i18n>SecondoLivello.treeTable.macroAttivita}"/>
                            <t:template>
                                <HBox renderType="Bare" justifyContent="Center" alignItems="Center">
                                    <customData>
                                        <core:CustomData key="opacityExternalOp" value="{= ${SecondoLivelloModel>workcenter} !== ${customDataWCModel>/workcenter} &amp;&amp; ${SecondoLivelloModel>parent_workcenter} !== ${customDataWCModel>/workcenter} ? 'Mismatch' : 'Match' }"  writeToDom="true"/>
                                    </customData>
                                    <customData>
                                        <core:CustomData key="boldDescriptioTask" value="{= ${SecondoLivelloModel>mark} ? 'Bold' : 'NoBold' }"  writeToDom="true"/>
                                    </customData>
                                    <Link text="{SecondoLivelloModel>macroAttivita}" press="onCellDescriptionPress" wrapping="true" class="textMacroAttivita treeTextClickable"/>
                                </HBox>
                            </t:template>
                        </t:Column>
                        <t:Column width="10%" hAlign="Center" sortProperty="workcenter" filterProperty="workcenter">
                            <Label text="{i18n>SecondoLivello.treeTable.wc}"/>
                            <t:template>
                                <HBox renderType="Bare" justifyContent="Center" alignItems="Center">
                                    <customData>
                                        <core:CustomData key="opacityExternalOp" value="{= ${SecondoLivelloModel>workcenter} !== ${customDataWCModel>/workcenter} &amp;&amp; ${SecondoLivelloModel>parent_workcenter} !== ${customDataWCModel>/workcenter} ? 'Mismatch' : 'Match' }"  writeToDom="true"/>
                                    </customData>
                                    <Text text="{SecondoLivelloModel>workcenter}"/>
                                </HBox>
                            </t:template>
                        </t:Column>
                        <t:Column width="8%" hAlign="Center" sortProperty="nonconformances">
                            <Label text="{i18n>SecondoLivello.treeTable.nc}"/>
                            <t:template>
                                <HBox renderType="Bare" justifyContent="Center" alignItems="Center">
                                    <customData>
                                        <core:CustomData key="opacityExternalOp" value="{= ${SecondoLivelloModel>workcenter} !== ${customDataWCModel>/workcenter} &amp;&amp; ${SecondoLivelloModel>parent_workcenter} !== ${customDataWCModel>/workcenter} ? 'Mismatch' : 'Match' }"  writeToDom="true"/>
                                    </customData>
                                    <core:Icon src="sap-icon://high-priority" color="#ca0b30" visible="{SecondoLivelloModel>nonconformances}" class="iconSecondoLivello" />
                                </HBox>
                            </t:template>
                        </t:Column>
                        <t:Column width="8%" hAlign="Center" sortProperty="status">
                            <Label text="{i18n>SecondoLivello.treeTable.status}"/>
                            <t:template>
                                <HBox renderType="Bare" justifyContent="Center" alignItems="Center">
                                    <customData>
                                        <core:CustomData key="opacityExternalOp" value="{= ${SecondoLivelloModel>workcenter} !== ${customDataWCModel>/workcenter} &amp;&amp; ${SecondoLivelloModel>parent_workcenter} !== ${customDataWCModel>/workcenter} ? 'Mismatch' : 'Match' }"  writeToDom="true"/>
                                    </customData>
                                    <core:Icon src="{path: 'SecondoLivelloModel>status',formatter: '.getStatusIconLev2and3'}" color="{path: 'SecondoLivelloModel>status', formatter: '.getStatusColorLev2and3' }" class="iconSecondoLivello" />
                                </HBox>
                            </t:template>
                        </t:Column>  
                        <t:Column width="10%" hAlign="Center">
                            <Label text="{i18n>SecondoLivello.treeTable.mark}"/>
                            <t:template>
                                <HBox renderType="Bare" justifyContent="Center" alignItems="Center">
                                    <customData>
                                        <core:CustomData key="opacityExternalOp" value="{= ${SecondoLivelloModel>workcenter} !== ${customDataWCModel>/workcenter} &amp;&amp; ${SecondoLivelloModel>parent_workcenter} !== ${customDataWCModel>/workcenter} ? 'Mismatch' : 'Match' }"  writeToDom="true"/>
                                    </customData>
                                    <Button text="{i18n>SecondoLivello.treeTable.mark}" width="100%" press="onMarkPress" visible="{SecondoLivelloModel>mark}" />
                                </HBox>
                            </t:template>
                        </t:Column>
                        <t:Column width="10%" hAlign="Center" sortProperty="safety" filterProperty="safety">
                            <Label text="{i18n>SecondoLivello.treeTable.safety}"/>
                            <t:template>
                                <HBox renderType="Bare" justifyContent="Center" alignItems="Center">
                                    <customData>
                                        <core:CustomData key="opacityExternalOp" value="{= ${SecondoLivelloModel>workcenter} !== ${customDataWCModel>/workcenter} &amp;&amp; ${SecondoLivelloModel>parent_workcenter} !== ${customDataWCModel>/workcenter} ? 'Mismatch' : 'Match' }"  writeToDom="true"/>
                                    </customData>
                                    <Text text="{SecondoLivelloModel>safety}"/>
                                </HBox>
                            </t:template>
                        </t:Column>  
                        <t:Column width="8%" hAlign="Center">
                            <Label text="{i18n>SecondoLivello.treeTable.info}"/>
                            <t:template>
                                <HBox renderType="Bare" justifyContent="Center" alignItems="Center">
                                    <customData>
                                        <core:CustomData key="opacityExternalOp" value="{= ${SecondoLivelloModel>workcenter} !== ${customDataWCModel>/workcenter} &amp;&amp; ${SecondoLivelloModel>parent_workcenter} !== ${customDataWCModel>/workcenter} ? 'Mismatch' : 'Match' }"  writeToDom="true"/>
                                    </customData>
									<Button
										text="Info" width="100%"
                                        visible="{SecondoLivelloModel>info}"
										type="{= ${SecondoLivelloModel>has_comments} ? 'Emphasized' : 'Transparent' }"
										press="onInfoOperationPress"/>
                                </HBox>
                            </t:template>
                        </t:Column>
                    </t:columns>
                </t:TreeTable>
            </VBox>
        </content>
    </Page>
</mvc:View>